{-# LANGUAGE DeriveDataTypeable #-}
{-# OPTIONS_GHC -XFlexibleInstances #-}


--------------------------------------------------------------------------
--------------------------------- Module ---------------------------------
--------------------------------------------------------------------------
module Valuation
    ( 
     Valuable, value, valueGreeks,
     Engine (..), ValueStorage (..)
    ) where

--------------------------------------------------------------------------
------------------------------- Imports ----------------------------------
--------------------------------------------------------------------------
import Utils.MyJSON
import Utils.MyUtils  
--------------------------------------------------------------------------
------------------------------- Classes ----------------------------------
--------------------------------------------------------------------------

class Valuable a where
    value       :: a -> Result_ ValueStorage
    valueGreeks :: a -> Result_ ValueStorage
    
--------------------------------------------------------------------------
-------------------------------- Alias -----------------------------------
--------------------------------------------------------------------------

--------------------------------------------------------------------------
------------------------------- Data -------------------------------------
--------------------------------------------------------------------------
data Engine = Analytical | MonteCarlo | Tree | PDE 
              deriving (Eq, Show, Data, Typeable) 
--------------------------------------------------------------------------
data ValueStorage = ValueStorage {
                                     vsValue :: Double, 
                                     vsSubValues :: [ValueStorage]
                                 } 
                  | ValueGreeksStorage {
                                           vgsValue :: Double, 
                                           vgsGreeks :: [Double], 
                                           vgsSubValues :: [ValueStorage]
                                       } deriving (Eq, Show, Data, Typeable)


